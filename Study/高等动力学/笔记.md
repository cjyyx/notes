# 虚位移原理与达朗贝尔原理

## 约束、自由度与广义坐标

几何约束： 仅限制质点系空间位形的约束。

$$
f_{g}(\boldsymbol{r}_{i},t)=f_{g}(x_{i},y_{i},z_{i};t)=0\:,\quad i=1,2,\cdots,n
$$

**完整约束**：包括几何约束和可转化成几何约束的运动约束。仅受完整约束的质点系，称为完整系统。

广义坐标 $q_j$：确定系统位形所需的独立参变量。完整系统的广义坐标数等于自由度 $k$。

系统各个质点的坐标通过广义坐标表示为

$$
\boldsymbol{r}_{i}=\boldsymbol{r}_{i}(q_1,q_2,\cdots,q_k;t)\:,\quad i=1,2,\cdots,n
$$

广义速度 $\dot{q}_{j}$：广义坐标关于时间的导数。

系统各个质点的速度通过广义速度表示为

$$
\dot{\boldsymbol{r}}_{i}=\sum_{j=1}^{k}\frac{\partial \boldsymbol{r}_{i}}{\partial q_{j}}\dot{q}_{j}+\frac{\partial \boldsymbol{r}_{i}}{\partial t}\:,\quad i=1,2,\cdots,n
$$

## 虚位移、虚功与广义力

虚位移：某瞬时，质点或质点系满足约束条件的任何无限小位移，记为 $\delta\boldsymbol{r}$。虚位移不同于真实位移，它是假想的，与真实运动、主动力、时间等无关，只受约束限制。

对于 $n$ 个质点组成、受 $s$ 个完整约束的系统，其 $k=3n-s$ 个广义坐标相应的广义虚位移 $\delta q_1, \delta q_2, \cdots \delta q_k$ 是相互独立的。而各个质点的矢量坐标相应的虚位移 $\delta\boldsymbol{r}_1, \delta\boldsymbol{r}_2, \cdots \delta\boldsymbol{r}_n$ 相互不完全独立，它们可以按照变分运算通过独立的广义虚位移表示为

$$
\delta \boldsymbol{r}_i=\sum_{j=1}^k\frac{\partial \boldsymbol{r}_i}{\partial q_j}\delta q_j\:,\quad i=1,\:2,\cdots,n
$$

虚功：力在虚位移上所作的功。

$$
\delta W=\boldsymbol{F}_i\cdot\delta \boldsymbol{r}_i=\sum_{j=1}^k\left(\boldsymbol{F}_i\cdot\frac{\partial \boldsymbol{r}_i}{\partial q_j}\right)\delta q_j
$$

其中 $Q_j = \boldsymbol{F}_i \cdot (\partial \boldsymbol{r}_i / \partial q_j)$，称为力 $\boldsymbol{F}_i$ 相应于广义坐标 $q_j$ 的广义力.

质点系的广义力将是各个力相应的广义力之和。虚功也可表示为各个广义力与广义虚位移乘积之和。

**理想约束**：如果系统的约束力在任何虚位移上所作的功之和等于零，则称该约束为理想约束。

## 虚位移原理与达朗贝尔原理

虚位移原理（虚功原理）：具有双面、定常、理想约束的质点系，保持平衡的充分必要条件是，作用于该质点系的所有主动力在任何虚位移上所作的虚功之和等于零。

$$
\sum \delta W = \sum \boldsymbol{F}_i \cdot \delta \boldsymbol{r}_i = 0
$$

达朗贝尔（D’Alembert）原理：质点系在任一瞬时，作用于其上的所有主动力、约束力和惯性力在形式上组成平衡力系。

刚体具有对称平面，并作平行于该对称平面的平面运动时，其上的惯性力系可等效为作用于对称面的一个力和一个力偶，这个力 $F_{\mathrm{g}C}$ 作用于刚体的质心$C$，这个力偶 $M_{\mathrm{g}C}$ 也绕该点， 且有

$$
F_{\mathrm{g}C}=-m a_C,\quad M_{\mathrm{g}C}=-J_{C}\alpha
$$

其中 $J_{C}$ 为刚体关于与对称面垂直的质心轴的转动惯量。


# 拉格朗日方程

**保守系统**受到的主动力都是有势力。

## 第二类拉格朗日方程

$$
\frac{\partial \boldsymbol{r}_i}{\partial q_j}=\frac{\partial\dot{\boldsymbol{r}}_i}{\partial\dot{q}_j} ,\quad \frac{\mathrm{d}}{\mathrm{d}t}(\frac{\partial \boldsymbol{r}_i}{\partial q_j})=\frac{\partial\dot{\boldsymbol{r}}_i}{\partial q_j} ,\quad \frac{\partial\ddot{\boldsymbol{r}}_i}{\partial\dot{q}_j}=2\frac{\partial\dot{\boldsymbol{r}}_i}{\partial q_j}
$$

假设双面、定常、理想约束


$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial T}{\partial\dot{q}_j}\right)-\frac{\partial T}{\partial q_j}=Q_j
$$

$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}_j}\right)-\frac{\partial L}{\partial q_j}=Q_j ,\quad L=T-V
$$

虚功

$$
Q_j=\frac{\Big[\sum\delta W\Big]_j}{\delta q_j}
$$

其中 $\left[\sum\delta W\right]_j$ 是仅广义虚位移 $\delta q_j\neq0$ 时的质点系总虚功。

## 广义速度表示的动能

$$
T=T_2+T_1+T_0
$$

$$
\begin{aligned}
T_{2}=\frac{1}{2}\sum_{i=1}^{k}\sum_{j=1}^{k}a_{ij}\dot{q}_{i}\dot{q}_{j}&,\quad a_{ij}=\sum_{l=1}^{n}m_{l}\frac{\partial\boldsymbol{r}_{l}}{\partial q_{i}}\cdot\frac{\partial\boldsymbol{r}_{l}}{\partial q_{j}} \\
T_1=\sum_{i=1}^kb_i\dot{q}_i&,\quad b_i=\sum_{l=1}^nm_l\frac{\partial\boldsymbol{r}_l}{\partial q_i}\cdot\frac{\partial\boldsymbol{r}_l}{\partial t} \\
T_{0}=c&=\frac{1}{2}\sum_{l=1}^{n}m_{l}\frac{\partial \boldsymbol{r}_l}{\partial t}\cdot\frac{\partial\boldsymbol{r}_l}{\partial t}
\end{aligned}
$$

系数矩阵 $[a_{ij}]$ 对称正定

## 耗散力与陀螺力

系统在运动过程中，可能存在与外界的能量交换，相应的作用力通常依赖于运动速度。系统中与速度相关的力主要有两类：耗散力与陀螺力。

力的功率表示为

$$
P=\dot{W}=\sum_{i=1}^n\boldsymbol{F}_i\cdot\dot{\boldsymbol{r}}_i=\sum_{j=1}^kQ_j\dot{q}_j
$$

耗散力

$$
Q_j=-\frac{\partial\Phi}{\partial\dot{q}_{j}}
$$

$$
\Phi=\sum_{i=1}^nc_i\int_0^{v_i}f_i(v)\mathrm{d}v
$$

通常的陀螺力是速度的线性函数，相应的广义陀螺力为

$$
Q_j=\sum_{i=1}^kg_{ij}\dot{q}_i
$$

系数矩阵 $[g_{ij}]$ 反对称

# 哈密顿方程

## 勒让德变换


勒让德变换的主要目的是将一个凸函数 $f(x)$ 转换成一个新的函数 $g(p)$，其中新函数的自变量是原函数的导数 $p = \frac{df}{dx}$，从而提供一种等价的描述方式。

设 $f(x)$ 是一个可微的凸函数，其导数 $p$ 由

$$
p = \frac{df}{dx}
$$

给出。我们定义勒让德变换对应的新函数 $g(p)$ 为：

$$
g(p) = x p - f(x)
$$

其中 $x$ 由 $p = \frac{df}{dx}$ 反解得到。

勒让德变换的逆变换也是勒让德变换。

## 哈密顿方程

由广义坐标构成的 $k$ 维空间称为位形空间。但系统的动力学状态取决于广义坐标和广义速度，由此 $2k$ 个变量构成的空间称为状态空间或相空间。

广义动量

$$
p_i=\frac{\partial L}{\partial\dot{q}_i}
$$

哈密顿方程以广义动量和广义坐标作为描述系统的状态变量。对于保守系统

$$
H=\Big(\sum_{i=1}^kp_i\dot{q}_i-L\Big)_{q_i\to p_i}
$$

$$
\dot{q}_i=\frac{\partial H}{\partial p_i},\quad\dot{p}_i=-\frac{\partial H}{\partial q_i},\quad i=1,2,\cdots,k
$$

由 $L=T_2+T_1+T_0-V$，得

$$
H=T_2+V-T_0
$$


对于非保守系统

$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}_i}\right)-\frac{\partial L}{\partial q_i}=\tilde{Q}_i
$$

$$
\dot{q}_i=\frac{\partial H}{\partial p_i},\quad\dot{p}_i=-\frac{\partial H}{\partial q_i}+\tilde{Q}_i
$$

## 泊松括号与积分定理

泊松（Poisson）建立了泊松括号的运算规则，并由此提出利用哈密顿方程的若干首次积分进一步求得其他首次积分的一般性方法。


$$
\left[\varphi,\psi\right]=\sum_{i=1}^k
\begin{vmatrix}
\dfrac{\partial\varphi}{\partial q_i} & \dfrac{\partial\psi}{\partial q_i} \\\\
\dfrac{\partial\varphi}{\partial p_i} & \dfrac{\partial\psi}{\partial p_i}
\end{vmatrix}
$$

哈密顿方程

$$
\dot{q}_i=
\begin{bmatrix}
q_i,H
\end{bmatrix},\quad\dot{p}_i=
\begin{bmatrix}
p_i,H
\end{bmatrix}+\tilde{Q}_i
$$

保守系统状态变量的任意函数关于时间 $t$ 的全导数

$$
\frac{\mathrm{d}f}{\mathrm{d}t}=\begin{bmatrix}
f,H
\end{bmatrix}+\frac{\partial f}{\partial t}
$$

