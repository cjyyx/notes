# 力控制

## 约束坐标系

为了描述机器人与环境之间的相互作用，令 $\xi=(v^T,\omega^T)^T$ 表示末端执行器的瞬时线速度和瞬时加速度，令 $F=(f^T,n^T)^T$ 表示作用在末端执行器上的瞬时力和瞬时力矩。向量 $\xi$ 和 $F$ 均为 6 维向量空间中的元素。

**自然约束**，特定接触条件下自然形成，与期望运动无关，满足对偶条件

$$
\xi^{\mathrm{T}}F=0
$$

**人工约束**，用于运动和力控制任务的参考输入。

**装配策略**为完成任务而事先规划好的人工约束序列。策略需包含检测手段以检测接触状态的变化，并跟踪自然约束的变化。当自然约束变化时，要调用新的人工约束集并进行控制。

## 力位混合控制

力位混合控制器需要在存在自然力约束的方向进行操作臂的位置控制，在存在自然位置约束的方向进行操作臂的力控制。

**质量-弹簧系统**

![](PasteImage/2024-04-17-09-31-37.png)

$$
f=mk_e^{-1}\ddot{f}_e+f_e+f_{dist}
$$
令 $e_f=f_d-f_e$ ，设计控制律为

$$
f=mk_e^{-1}[\ddot{f}_d+k_{vf}\dot{e}_f+k_{pf}e_f]+f_e+f_{dist}
$$

由此得到误差线性系统

$$
\ddot{e}_f+k_{vf}\dot{e}_f+k_{pf}e_f=0
$$

力检测的噪声很大，无法数值微分，可由 $\dot{f}_e=k_e\dot{x}$ 代替，通过机械臂的速度测量代替力的微分。

![](PasteImage/2024-04-17-09-05-54.png)

## 阻抗控制

许多情况下，交互过程往往伴随着能量的转移，这时单一的位置、速度或力控制就不足以控制交互过程的能量流动。阻抗控制，设计控制器使交互力与机械臂位置之间呈现出期望的关系，从而实现柔顺控制。

**机械阻抗**定义为复频域内作用力与速度的比值 $\dfrac{F(s)}{\dot{X}(s)}$

理想的位置控制器对应高阻抗，要在外力干扰下维持运动状态不变；理想的力控制器对应低阻抗，要保持期望的作用力，不受位置变化的干扰。

阻抗控制的目标不是力或位置的轨迹，而是物体对外界所表现出的动力学特性。

**例：**

质量块的位移为 $x$ ，质量为 $m$ ，$F_{ext}$ 和 $F$ 分别为环境施加的外力和控制力。则运动方程为

$$
m\ddot{x}=F+F_{ext}
$$

质量块的期望轨迹为 $x_d(t)$，令 $\tilde{x}(t)=x(t)-x_d(t)$ 表示运动的跟踪误差，则阻抗控制的目标为

$$
M_d\ddot{\tilde{x}}+B_d\dot{\tilde{x}}+K_d\tilde{x}=F_{ext}
$$

其中 $M_d,B_d,K_d$ 分别表示期望的惯量、阻尼和刚度。

传感器测量当前位置与目标位置的偏差，并调整控制力的大小来达到预期的阻抗关系。阻抗控制律可以表示为

$$
F=m\ddot{x}_d+(m-M_d)\ddot{\tilde{x}}-\left(B_d\dot{\tilde{x}}+K_d\tilde{x}\right)
$$

上式中出现了跟踪误差的二阶导数，在实际系统中会引入严重的测量噪声。通过测量外力，可以将控制律改为

$$
F=m\ddot{x}_d-\frac m{M_d}\left(B_d\dot{\tilde{x}}+K_d\tilde{x}\right)+\left(\frac m{M_d}-1\right)F_{ext}
$$

**机械臂动力学**

关节空间动力学

$$
M(\Theta)\ddot{\Theta}+V(\Theta,\dot{\Theta})+G(\Theta)=\tau+J^T(\Theta)F
$$



笛卡尔空间动力学

$$
M_X(\Theta)\ddot{X}+V_X(\Theta,\dot{\Theta})+G_X(\Theta)=J_\alpha^{-T}(\Theta)\tau+F_\alpha 
$$

阻抗控制基于测量的位置来控制外力，需要直接对关节力矩进行控制，但很多机械臂不开放底层力矩控制接口。此时可以使用**导纳控制**来实现与环境接触时的阻抗特性。导纳控制基于测量的外力来控制位置，只需要发送位置/速度指令。





